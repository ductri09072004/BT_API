# Monitoring Makefile for BT_API

.PHONY: install deploy status logs clean

# CÃ i Ä‘áº·t monitoring stack
install:
	@echo "ğŸš€ Installing Prometheus + Grafana..."
	@bash install-monitoring.sh

# Deploy full monitoring vá»›i dashboard
deploy:
	@echo "ğŸ”§ Deploying complete monitoring stack..."
	@bash deploy-monitoring.sh

# Kiá»ƒm tra tráº¡ng thÃ¡i monitoring
status:
	@echo "ğŸ“Š Monitoring Status:"
	@kubectl get pods -n monitoring
	@echo ""
	@kubectl get services -n monitoring

# Xem logs Grafana
logs:
	@kubectl logs -f deployment/prometheus-grafana -n monitoring

# Port forward Ä‘á»ƒ truy cáº­p local
port-forward:
	@echo "ğŸŒ Starting port forwarding..."
	@echo "Grafana: http://localhost:30000"
	@echo "Prometheus: http://localhost:30001"
	@kubectl port-forward -n monitoring svc/prometheus-grafana 30000:80 &
	@kubectl port-forward -n monitoring svc/prometheus-kube-prometheus-prometheus 30001:9090 &

# XÃ³a monitoring stack
clean:
	@echo "ğŸ§¹ Cleaning up monitoring stack..."
	@helm uninstall prometheus -n monitoring
	@kubectl delete namespace monitoring

# Kiá»ƒm tra metrics tá»« services
metrics:
	@echo "ğŸ“ˆ BT_API Services Metrics:"
	@kubectl top pods -n bt-api
	@echo ""
	@kubectl top nodes
